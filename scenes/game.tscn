[gd_scene load_steps=25 format=3 uid="uid://del72vip3ke8o"]

[ext_resource type="Script" path="res://scenes/game.gd" id="1_8shy6"]
[ext_resource type="Texture2D" uid="uid://mq4kbdkwpeo0" path="res://assets/materials/textures/prototype_texture.png" id="1_vnqn7"]
[ext_resource type="Script" path="res://scenes/ChangeColor.gd" id="2_oyjsx"]
[ext_resource type="PackedScene" uid="uid://c570gqhngvxy6" path="res://assets/scn/Car.scn" id="2_wygbo"]
[ext_resource type="PackedScene" uid="uid://bljsea7mi3tqx" path="res://assets/scn/3DCamera.scn" id="3_adcb6"]
[ext_resource type="PackedScene" uid="uid://80q5ukhbxqkf" path="res://scenes/gui.tscn" id="5_80jw4"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_dc3u0"]
sky_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)
ground_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)

[sub_resource type="Sky" id="Sky_2212x"]
sky_material = SubResource("ProceduralSkyMaterial_dc3u0")

[sub_resource type="Environment" id="Environment_puqy4"]
background_mode = 2
sky = SubResource("Sky_2212x")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tr8bl"]
albedo_texture = ExtResource("1_vnqn7")
uv1_scale = Vector3(100, 100, 100)

[sub_resource type="PlaneMesh" id="PlaneMesh_wh4pi"]
material = SubResource("StandardMaterial3D_tr8bl")
size = Vector2(100, 100)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_jb335"]
data = PackedVector3Array(50, 0, 50, -50, 0, 50, 50, 0, -50, -50, 0, 50, -50, 0, -50, 50, 0, -50)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_pcntk"]
albedo_texture = ExtResource("1_vnqn7")
uv1_scale = Vector3(100, 2, 1)

[sub_resource type="PlaneMesh" id="PlaneMesh_a0o6w"]
material = SubResource("StandardMaterial3D_pcntk")
size = Vector2(100, 4)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_lg26e"]
data = PackedVector3Array(50, 0, 2, -50, 0, 2, 50, 0, -2, -50, 0, 2, -50, 0, -2, 50, 0, -2)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_2ffjo"]
data = PackedVector3Array(50, 0, 2, -50, 0, 2, 50, 0, -2, -50, 0, 2, -50, 0, -2, 50, 0, -2)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_daudj"]
data = PackedVector3Array(50, 0, 2, -50, 0, 2, 50, 0, -2, -50, 0, 2, -50, 0, -2, 50, 0, -2)

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_2la5w"]
data = PackedVector3Array(50, 0, 2, -50, 0, 2, 50, 0, -2, -50, 0, 2, -50, 0, -2, 50, 0, -2)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_45f5d"]
albedo_color = Color(1, 0, 0.101961, 1)
metallic = 0.7
roughness = 0.5
emission = Color(1, 0, 0, 1)
refraction_scale = -0.24

[sub_resource type="CylinderMesh" id="CylinderMesh_ys5lp"]
material = SubResource("StandardMaterial3D_45f5d")
top_radius = 2.0
bottom_radius = 2.0
height = 0.1

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_gben2"]
emission_shape = 2
emission_sphere_radius = 2.0
spread = 180.0
gravity = Vector3(0, 1, 0)
collision_mode = 1
collision_friction = 0.0
collision_bounce = 0.0

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_eaej0"]
transparency = 1
albedo_color = Color(0.0862745, 0.172549, 1, 0.466667)

[sub_resource type="SphereMesh" id="SphereMesh_xirp1"]
material = SubResource("StandardMaterial3D_eaej0")
radius = 0.05
height = 0.1

[sub_resource type="CylinderShape3D" id="CylinderShape3D_wo12c"]
height = 1.0
radius = 2.0

[node name="Game" type="Node3D"]
script = ExtResource("1_8shy6")
gui_path = NodePath("GUI")
car_path = NodePath("Car")

[node name="GUI" parent="." instance=ExtResource("5_80jw4")]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_puqy4")

[node name="Map" type="Node3D" parent="."]

[node name="Floor" type="MeshInstance3D" parent="Map"]
mesh = SubResource("PlaneMesh_wh4pi")
skeleton = NodePath("../..")

[node name="StaticBody3D" type="StaticBody3D" parent="Map/Floor"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/Floor/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_jb335")

[node name="WallN" type="MeshInstance3D" parent="Map"]
transform = Transform3D(-1, -3.82137e-15, 8.74228e-08, -8.74228e-08, 4.37114e-08, -1, 0, -1, -4.37114e-08, 0, 2, 50)
mesh = SubResource("PlaneMesh_a0o6w")

[node name="StaticBody3D" type="StaticBody3D" parent="Map/WallN"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/WallN/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_lg26e")

[node name="WallW" type="MeshInstance3D" parent="Map"]
transform = Transform3D(-4.37114e-08, -1, 4.37114e-08, 0, -4.37114e-08, -1, 1, -4.37114e-08, 1.91069e-15, 50, 2, 0)
mesh = SubResource("PlaneMesh_a0o6w")

[node name="StaticBody3D" type="StaticBody3D" parent="Map/WallW"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/WallW/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_2ffjo")

[node name="WallE" type="MeshInstance3D" parent="Map"]
transform = Transform3D(-4.37114e-08, 1, -4.37114e-08, 0, -4.37114e-08, -1, -1, -4.37114e-08, 1.91069e-15, -50, 2, 0)
mesh = SubResource("PlaneMesh_a0o6w")

[node name="StaticBody3D" type="StaticBody3D" parent="Map/WallE"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/WallE/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_daudj")

[node name="WallS" type="MeshInstance3D" parent="Map"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 2, -50)
mesh = SubResource("PlaneMesh_a0o6w")

[node name="StaticBody3D" type="StaticBody3D" parent="Map/WallS"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/WallS/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_2la5w")

[node name="ChangeColor" type="Node3D" parent="Map"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 0, 0.0986948)
script = ExtResource("2_oyjsx")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Map/ChangeColor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.0405182, 0)
mesh = SubResource("CylinderMesh_ys5lp")

[node name="GPUParticles3D" type="GPUParticles3D" parent="Map/ChangeColor"]
amount = 100
visibility_aabb = AABB(-2, 0, -2, 4, 2.5, 4)
process_material = SubResource("ParticleProcessMaterial_gben2")
draw_pass_1 = SubResource("SphereMesh_xirp1")

[node name="Area3D" type="Area3D" parent="Map/ChangeColor"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Map/ChangeColor/Area3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
shape = SubResource("CylinderShape3D_wo12c")

[node name="Car" parent="." instance=ExtResource("2_wygbo")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0048914, 0.386833, -0.0917931)

[node name="3DCamera" parent="." node_paths=PackedStringArray("look_at") instance=ExtResource("3_adcb6")]
look_at = NodePath("../Car")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.760134, -0.30235, 0.575136, 0, 0.885142, 0.465321, -0.649767, -0.353706, 0.672826, 0, 0, 0)
shadow_enabled = true
directional_shadow_mode = 1
directional_shadow_split_1 = 0.15

[connection signal="color_changing" from="GUI" to="." method="_on_gui_color_changing"]
[connection signal="color_close" from="GUI" to="." method="_on_gui_color_close"]
[connection signal="change_car_color" from="Map/ChangeColor" to="." method="_on_change_car_color"]
[connection signal="body_shape_entered" from="Map/ChangeColor/Area3D" to="Map/ChangeColor" method="_on_area_3d_body_shape_entered"]
